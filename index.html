<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fl√¢nerie - The Art of Urban Wandering</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&family=Playfair+Display:wght@400;600;700;800&family=Crimson+Text:wght@400;600;700&display=swap" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            scroll-behavior: smooth;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            overflow-x: hidden;
            background: #0a0a0a;
            color: #8DBCC0;
            --accent-color: #6B9B9E;
            --accent-light: #8DBCC0;
        }
        
        body.choreography-active {
            overflow: hidden;
            height: 100vh;
            position: fixed;
            width: 100%;
        }
        
        /* Navigation - Centered, No Logo */
        nav {
            position: fixed;
            top: 0;
            width: 100%;
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(10px);
            padding: 1.5rem 2rem;
            z-index: 1000;
            border-bottom: 1px solid rgba(107, 155, 158, 0.2);
        }
        
        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .nav-links {
            display: flex;
            gap: 3rem;
            list-style: none;
        }
        
        .nav-links a {
            text-decoration: none;
            color: var(--accent-light);
            font-weight: 500;
            font-size: 1.1rem;
            transition: color 0.3s ease;
        }
        
        .nav-links a:hover {
            color: #ffffff;
        }
        
        /* Hero Section */
        .hero {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            position: relative;
            padding: 6rem 2rem 4rem;
            background: url('character-bg.png') center/cover fixed;
        }
        
        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(10, 10, 10, 0.75);
            backdrop-filter: blur(8px);
            z-index: 1;
        }
        
        .hero-content {
            position: relative;
            z-index: 2;
            max-width: 900px;
        }
        
        .hero h1 {
            font-family: 'Playfair Display', serif;
            font-size: 7rem;
            font-weight: 400;
            color: var(--accent-light);
            margin-bottom: 1rem;
            letter-spacing: 3px;
            text-shadow: 0 5px 30px rgba(0, 0, 0, 0.8);
        }
        
        .hero-subtitle {
            font-size: 1.8rem;
            color: var(--accent-light);
            font-weight: 300;
            margin-bottom: 2rem;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.8);
        }
        
        .hero-logo-btn {
            width: 200px;
            height: 200px;
            margin: 0 auto 2rem;
            border-radius: 50%;
            background: url('character-logo.png') center/cover;
            border: 5px solid var(--accent-color);
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 40px rgba(107, 155, 158, 0.4);
            animation: float 3s ease-in-out infinite;
        }
        
        .hero-logo-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 15px 60px rgba(107, 155, 158, 0.6);
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        /* Rotating phrases below logo */
        .rotating-text-container {
            min-height: 50px;
            position: relative;
            margin-bottom: 1rem;
        }
        
        .rotating-text {
            position: relative;
            width: 100%;
            text-align: center;
        }
        
        .rotating-text span {
            position: absolute;
            width: 100%;
            left: 0;
            opacity: 0;
            color: var(--accent-light);
            font-size: 1.2rem;
            font-weight: 300;
            font-style: italic;
            transition: opacity 1s ease-in-out;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.8);
        }
        
        .rotating-text span.active {
            opacity: 1;
        }
        
        .scroll-hint {
            position: absolute;
            bottom: 3rem;
            left: 50%;
            transform: translateX(-50%);
            color: var(--accent-light);
            font-size: 0.9rem;
            opacity: 0.7;
            animation: bounce 2s ease-in-out infinite;
            z-index: 2;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateX(-50%) translateY(0); }
            50% { transform: translateX(-50%) translateY(-10px); }
        }
        
        /* Main Content */
        .main-content {
            position: relative;
            background: #0a0a0a;
            padding: 6.5rem 0 2rem;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
        }
        
        /* Info Section - Definition */
        .info-section {
            text-align: center;
            padding: 1.5rem 0 0.5rem;
            max-width: 900px;
            margin: 0 auto 1.5rem;
        }
        
        .definition-box-animated {
            margin-bottom: 1.2rem;
            text-align: left;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            background: rgba(30, 30, 30, 0.8);
            padding: 1.3rem;
            border-radius: 15px;
            border-left: 4px solid var(--accent-color);
        }
        
        .definition-box-animated h2 {
            font-family: 'Playfair Display', serif;
            font-size: 2.6rem;
            font-weight: 400;
            color: var(--accent-light);
            margin-bottom: 0.4rem;
        }
        
        .definition-box-animated p {
            color: var(--accent-light);
            line-height: 1.7;
        }
        
        /* Welcome Section - Wider */
        #welcome-section {
            text-align: left;
            max-width: 1200px;
            margin: 0 auto 2rem;
            background: rgba(30, 30, 30, 0.5);
            padding: 2rem 3rem;
            border-radius: 20px;
        }
        
        #welcome-section h3 {
            font-family: 'Playfair Display', serif;
            color: var(--accent-color);
            font-size: 2.5rem;
            margin-bottom: 1.2rem;
        }
        
        #welcome-section p {
            font-size: 0.95rem;
            color: var(--accent-light);
            line-height: 1.65;
            margin-bottom: 0.9rem;
        }
        
        #welcome-section p:last-of-type {
            margin-bottom: 0;
        }
        
        #tagline-reveal {
            margin-top: 1rem;
            font-family: 'Playfair Display', serif;
            font-size: 1.8rem;
            color: var(--accent-color);
            font-style: italic;
            font-weight: 700;
            text-align: center;
        }
        
        /* Feature Cards - 2x2 Grid */
        .features-section {
            min-height: 100vh;
            padding: 10rem 2rem 3rem;
            scroll-margin-top: 140px;
            display: flex;
            align-items: flex-start;
            justify-content: center;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 3rem;
            max-width: 1400px;
            width: 100%;
            margin: 0 auto;
        }
        
        @media (max-width: 968px) {
            .feature-grid {
                grid-template-columns: 1fr;
                gap: 2rem;
            }
        }
        
        .feature-card-large {
            background: rgba(30, 30, 30, 0.9);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid rgba(107, 155, 158, 0.2);
        }
        
        .feature-card-large:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 60px rgba(107, 155, 158, 0.3);
            border-color: var(--accent-color);
        }
        
        .feature-content {
            position: relative;
            z-index: 3;
            text-align: left;
        }
        
        .feature-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--accent-color), var(--accent-light));
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
        }
        
        .feature-card-large h3 {
            font-family: 'Playfair Display', serif;
            font-size: 1.8rem;
            color: var(--accent-light);
            margin-bottom: 1rem;
        }
        
        .feature-card-large p {
            font-size: 1.1rem;
            color: #d4d4d4;
            line-height: 1.6;
            margin-bottom: 1.5rem;
        }
        
        .feature-btn {
            background: linear-gradient(135deg, var(--accent-color), var(--accent-light));
            color: white;
            padding: 1rem 3rem;
            border: none;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .feature-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(107, 155, 158, 0.5);
        }
        
        /* Upcoming Sections */
        .upcoming-section {
            background: linear-gradient(135deg, rgba(107, 155, 158, 0.15), rgba(141, 188, 192, 0.15));
            border: 2px solid rgba(107, 155, 158, 0.3);
            border-radius: 25px;
            padding: 3rem;
            margin: 0 auto 3rem;
            max-width: 1400px;
            min-height: 80vh;
            scroll-margin-top: 140px;
        }
        
        .upcoming-section h2 {
            font-family: 'Playfair Display', serif;
            font-size: 2.5rem;
            color: var(--accent-color);
            margin-bottom: 2rem;
            text-align: center;
        }
        
        .upcoming-cards {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 2.5rem;
        }
        
        @media (max-width: 1200px) {
            .upcoming-cards {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .upcoming-cards {
                grid-template-columns: 1fr;
            }
        }
        
        .upcoming-card {
            background: rgba(30, 30, 30, 0.9);
            border-radius: 20px;
            padding: 2rem;
            border: 2px solid rgba(107, 155, 158, 0.3);
            transition: all 0.3s ease;
        }
        
        .upcoming-card:hover {
            transform: translateY(-5px);
            border-color: var(--accent-color);
            box-shadow: 0 10px 40px rgba(107, 155, 158, 0.3);
        }
        
        .upcoming-card h3 {
            color: var(--accent-light);
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }
        
        .upcoming-card p {
            color: var(--accent-light);
            line-height: 1.8;
            margin: 0.5rem 0;
        }
        
        .event-type {
            display: inline-block;
            background: var(--accent-light);
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            font-size: 0.75rem;
            margin-bottom: 0.8rem;
            font-weight: 600;
        }
        
        /* Footer */
        footer {
            background: rgba(10, 10, 10, 0.98);
            color: var(--accent-light);
            padding: 3rem 2rem 2rem;
            border-top: 2px solid rgba(107, 155, 158, 0.3);
        }
        
        .footer-content {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 2rem;
            margin-bottom: 2rem;
        }
        
        @media (max-width: 768px) {
            .footer-content {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        .footer-section h4 {
            color: var(--accent-color);
            margin-bottom: 1rem;
        }
        
        .footer-section a {
            color: var(--accent-light);
            text-decoration: none;
            line-height: 2;
            transition: color 0.3s;
        }
        
        .footer-section a:hover {
            color: #ffffff;
        }
        
        .footer-section ul {
            list-style: none;
        }
        
        .footer-bottom {
            text-align: center;
            padding-top: 2rem;
            border-top: 1px solid rgba(107, 155, 158, 0.2);
            color: #999;
        }
        
        /* SLIDESHOW - CORRECTED */
        .slideshow-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: #0a0a0a;
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            pointer-events: none;
            overflow: hidden;
        }
        
        .slideshow-overlay.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .slide {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 1s ease-in-out;
            padding: 4rem 2rem;
        }
        
        .slide.active {
            opacity: 1;
        }
        
        .slide-content {
            text-align: center;
            max-width: 800px;
            width: 100%;
        }
        
        #slide-typewriter-with-image {
            justify-content: flex-start;
            padding-top: 15%;
        }
        
        #slide-typewriter-with-image .typewriter-section {
            margin-bottom: 3rem;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        #slide-typewriter-with-image .image-section {
            opacity: 0;
            transition: opacity 4s ease-in;
            display: flex;
            justify-content: center;
            width: 100%;
        }
        
        #slide-typewriter-with-image .image-section.fading {
            opacity: 1;
        }
        
        #slide-paragraph-with-image {
            justify-content: flex-start;
            padding-top: 8%;
        }
        
        #slide-paragraph-with-image .paragraph-section {
            margin-bottom: 3rem;
            display: flex;
            justify-content: center;
            width: 100%;
        }
        
        #slide-paragraph-with-image .image-section {
            opacity: 0;
            transition: opacity 3s ease-in;
            margin-top: 2rem;
            display: flex;
            justify-content: center;
            width: 100%;
        }
        
        #slide-paragraph-with-image .image-section.fading {
            opacity: 1;
        }
        
        #slide-paragraph-with-image .you-text {
            opacity: 0;
            transition: opacity 1.5s ease-in;
            font-family: 'Playfair Display', serif;
            color: var(--accent-color);
            font-size: 4rem;
            font-weight: 700;
            margin-bottom: 1rem;
        }
        
        #slide-paragraph-with-image .you-text.showing {
            opacity: 1;
        }
        
        #slide-welcome #welcome-text {
            font-family: 'Playfair Display', serif;
            color: var(--accent-color);
            font-size: 3rem;
            font-weight: 600;
            transition: transform 2s ease-out;
        }
        
        #slide-welcome #welcome-text.move-up {
            transform: translateY(-40px);
        }
        
        #slide-welcome #tagline-text {
            font-family: 'Playfair Display', serif;
            font-size: 2.5rem;
            color: var(--accent-color);
            font-style: italic;
            font-weight: 700;
            opacity: 0;
            margin-top: 2rem;
            transition: opacity 1s ease-in;
        }
        
        #slide-welcome #tagline-text.fade-in {
            opacity: 1;
        }
        
        #slideshow-typewriter-sentence {
            font-family: 'Crimson Text', serif;
            font-size: 1.6rem;
            color: var(--accent-light);
            font-weight: 600;
            text-align: center;
            min-height: 50px;
        }
        
        .slideshow-controls {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 10001;
            display: flex;
            gap: 1rem;
        }
        
        .slideshow-controls button {
            background: rgba(107, 155, 158, 0.3);
            border: 2px solid var(--accent-color);
            color: var(--accent-color);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }
        
        .slideshow-controls button:hover {
            background: var(--accent-color);
            color: #0a0a0a;
        }
        
        /* Mobile Responsive */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 3.5rem;
            }
            
            .hero-subtitle {
                font-size: 1.2rem;
            }
            
            .hero-logo-btn {
                width: 150px;
                height: 150px;
            }
            
            .nav-links {
                gap: 1rem;
                font-size: 0.9rem;
            }
            
            .container {
                padding: 0 1rem;
            }
            
            #welcome-section {
                padding: 2rem;
            }
            
            .definition-box-animated h2 {
                font-size: 2.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- SLIDESHOW -->
    <div id="slideshow-overlay" class="slideshow-overlay">
        <div class="slideshow-controls">
            <button id="rewind-btn" title="Restart">‚Ü∫</button>
            <button id="pause-btn" title="Pause/Play">‚è∏</button>
            <button id="skip-btn" title="Skip">‚è≠</button>
        </div>
        
        <!-- Slide 1: Definition -->
        <div class="slide active" id="slide-definition">
            <div class="slide-content">
                <h2 style="font-family: 'Playfair Display', serif; font-size: 4rem; color: var(--accent-light); margin-bottom: 1rem;">fl√¢nerie</h2>
                <p style="font-size: 1.2rem; color: var(--accent-light); margin-bottom: 2rem; font-style: italic;">| Ààfl…ëÀên…ôri |</p>
                <p style="font-size: 1.6rem; color: var(--accent-light); line-height: 1.8;">The art of leisurely urban exploration;<br>mindful wandering through city streets<br>with intention and curiosity.</p>
            </div>
        </div>
        
        <!-- Slide 2: Typewriter + Image -->
        <div class="slide" id="slide-typewriter-with-image">
            <div class="typewriter-section">
                <h3 style="font-family: 'Playfair Display', serif; color: var(--accent-color); font-size: 2.8rem; margin-bottom: 3rem; text-align: center;">Take Back Your Main Street</h3>
                <p id="slideshow-typewriter-sentence"></p>
            </div>
            
            <div class="image-section" id="empty-street-section">
                <img src="empty-street.png" alt="Empty street" style="max-width: 500px; width: 80%; height: auto; border-radius: 15px; box-shadow: 0 10px 40px rgba(0,0,0,0.5);">
            </div>
        </div>
        
        <!-- Slide 3: Paragraph + YOU + Image -->
        <div class="slide" id="slide-paragraph-with-image">
            <div class="paragraph-section">
                <p style="font-size: 1.3rem; color: var(--accent-light); line-height: 1.9; text-align: center; max-width: 800px;">
                    Search engines direct you to chains. Online shopping replaces neighborhood stores. Meanwhile, the caf√© owner who remembers your name can't make rent. Small businesses don't have marketing budgets or algorithms working for them ‚Äî they have...
                </p>
            </div>
            
            <div class="you-text" id="you-text">YOU</div>
            
            <div class="image-section" id="shopping-street-section">
                <img src="shopping-street.png" alt="Shopping street" style="max-width: 500px; width: 80%; height: auto; border-radius: 15px; box-shadow: 0 10px 40px rgba(0,0,0,0.5);">
            </div>
        </div>
        
        <!-- Slide 4: Welcome -->
        <div class="slide" id="slide-welcome">
            <div class="slide-content">
                <h3 id="welcome-text">Welcome to Fl√¢nerie</h3>
                <p id="tagline-text">
                    Share your journey.<br>Retrace theirs.
                </p>
            </div>
        </div>
    </div>
    
    <!-- Navigation -->
    <nav>
        <div class="nav-container">
            <ul class="nav-links">
                <li><a href="#home">Home</a></li>
                <li><a href="javascript:void(0)" onclick="scrollToContent()">How It Works</a></li>
                <li><a href="#features-content">Explore</a></li>
                <li><a href="for-businesses.html">For Businesses</a></li>
                <li><a href="about.html">About</a></li>
            </ul>
        </div>
    </nav>
    
    <!-- Hero Section -->
    <section class="hero" id="home">
        <div class="hero-content">
            <h1>Fl√¢nerie</h1>
            <p class="hero-subtitle">The art of urban wandering.</p>
            <div class="hero-logo-btn" onclick="scrollToContent()"></div>
            
            <!-- Rotating phrases below logo -->
            <div class="rotating-text-container">
                <div class="rotating-text">
                    <span class="active">Wander well.</span>
                    <span>Walk kindly.</span>
                    <span>Support local business.</span>
                    <span>Discover hidden gems in your neighborhood.</span>
                    <span>Turn ordinary walks into extraordinary adventures.</span>
                    <span>Connect with your community, one step at a time.</span>
                    <span>Every block has a story to tell.</span>
                    <span>Shop small, feel big.</span>
                    <span>Find your city's secrets.</span>
                    <span>Life moves fast - walk slower.</span>
                </div>
            </div>
        </div>
        <div class="scroll-hint">‚Üì Click to explore</div>
    </section>
    
    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <!-- Definition Section -->
            <section class="info-section">
                <div class="definition-box-animated">
                    <h2>fl√¢nerie</h2>
                    <p style="font-size: 1rem; color: var(--accent-light); margin-bottom: 0.3rem;">
                        | Ààfl…ëÀên…ôri | <span style="font-style: italic;">noun</span>
                    </p>
                    <div style="width: 60px; height: 1px; background: #555; margin: 1rem 0;"></div>
                    <p style="font-size: 1.3rem; color: var(--accent-light); line-height: 1.7;">
                        The art of leisurely urban exploration; mindful wandering through city streets with intention and curiosity.
                    </p>
                </div>
                
                <!-- Welcome Section -->
                <div id="welcome-section">
                    <h3>Welcome to Fl√¢nerie</h3>
                    
                    <p>
                        We turn ordinary walks into extraordinary mini-adventures. Rooted in French culture, fl√¢nerie celebrates <strong style="color: var(--accent-color);">the art of strolling</strong> ‚Äî observing city life with intention instead of rushing through it. It's <strong style="color: var(--accent-color);">cultural appreciation</strong> in motion: slowing down enough to notice the character and charm built into the everyday.
                    </p>
                    
                    <p>
                        With Fl√¢nerie, you can explore neighborhoods at your own pace or chart your own path. Our routes guide you from cozy caf√©s and local markets to boutique shops, art galleries, bookstores, parks, and hidden corners ‚Äî each designed for <strong style="color: var(--accent-color);">mindful wandering</strong> and curiosity-led discovery. Search routes shared by others, map your upcoming outings, browse local events, or gather friends for a <strong style="color: var(--accent-color);">Shopping Swarm</strong> ‚Äî a collective walk that turns routine errands into moments of connection and community support.
                    </p>
                    
                    <p>
                        <strong style="color: var(--accent-color);">Your route to that tiny coffee roaster? Someone else's new favorite spot. Your Shopping Swarm? A local merchant's best weekend in months.</strong> This is how communities strengthen themselves ‚Äî one walk, one recommendation, one conscious choice at a time.
                    </p>
                </div>
                
                <p id="tagline-reveal">Share your journey. Retrace theirs.</p>
            </section>
            
            <!-- Feature Cards - 4 in a row -->
            <div id="features-content" class="features-section">
                <div class="feature-grid">
                    <div class="feature-card-large" onclick="toggleSection('journey-map')" style="cursor: pointer;">
                        <div class="feature-content">
                            <div class="feature-icon">üìç</div>
                            <h3>Share Your Journey</h3>
                            <p>Plot your favorite routes</p>
                            <button class="feature-btn">Start Mapping</button>
                        </div>
                    </div>
                    
                    <div class="feature-card-large" onclick="toggleSection('search')" style="cursor: pointer;">
                        <div class="feature-content">
                            <div class="feature-icon">üîç</div>
                            <h3>Search Routes</h3>
                            <p>Discover curated paths</p>
                            <button class="feature-btn">Explore Routes</button>
                        </div>
                    </div>
                    
                    <div class="feature-card-large" onclick="toggleSection('swarms')" style="cursor: pointer;">
                        <div class="feature-content">
                            <div class="feature-icon">üõçÔ∏è</div>
                            <h3>Shopping Swarms</h3>
                            <p>Join community walks</p>
                            <button class="feature-btn">View Swarms</button>
                        </div>
                    </div>
                    
                    <div class="feature-card-large" onclick="toggleSection('events')" style="cursor: pointer;">
                        <div class="feature-content">
                            <div class="feature-icon">üéâ</div>
                            <h3>Local Events</h3>
                            <p>Discover celebrations</p>
                            <button class="feature-btn">Browse Events</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Upcoming Shopping Swarms -->
            <section class="upcoming-section">
                <h2>üõçÔ∏è Upcoming Shopping Swarms</h2>
                <div class="upcoming-cards">
                    <div class="upcoming-card">
                        <h3>Saturday Market Crawl</h3>
                        <p>üìÖ This Saturday, 10 AM</p>
                        <p>üìç Downtown Farmers Market</p>
                        <p style="color: var(--accent-color); font-weight: 600;">üë• 23 locals joining</p>
                    </div>
                    
                    <div class="upcoming-card">
                        <h3>Art Gallery Night Walk</h3>
                        <p>üìÖ Friday, 6 PM</p>
                        <p>üìç Arts District</p>
                        <p style="color: var(--accent-color); font-weight: 600;">üë• 15 locals joining</p>
                    </div>
                    
                    <div class="upcoming-card">
                        <h3>Coffee Shop Marathon</h3>
                        <p>üìÖ Sunday, 9 AM</p>
                        <p>üìç Various Locations</p>
                        <p style="color: var(--accent-color); font-weight: 600;">üë• 31 locals joining</p>
                    </div>
                </div>
            </section>
            
            <!-- Upcoming Events -->
            <section class="upcoming-section">
                <h2>üéâ Upcoming Local Events</h2>
                <div class="upcoming-cards">
                    <div class="upcoming-card">
                        <span class="event-type">Block Party</span>
                        <h3>Highland Street Festival</h3>
                        <p>üìÖ Saturday, June 15, 12-6 PM</p>
                        <p>üìç Highland Neighborhood</p>
                    </div>
                    
                    <div class="upcoming-card">
                        <span class="event-type">Art Walk</span>
                        <h3>First Friday Gallery Stroll</h3>
                        <p>üìÖ First Friday, 6-9 PM</p>
                        <p>üìç Santa Fe Arts District</p>
                    </div>
                    
                    <div class="upcoming-card">
                        <span class="event-type">Sidewalk Sale</span>
                        <h3>Pearl Street Summer Sale</h3>
                        <p>üìÖ July 20-22, 10 AM-7 PM</p>
                        <p>üìç Pearl Street Mall</p>
                    </div>
                </div>
            </section>
        </div>
    </main>
    
    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h4>Fl√¢nerie</h4>
                <p>The art of urban wandering.</p>
            </div>
            <div class="footer-section">
                <h4>Quick Links</h4>
                <ul>
                    <li><a href="about.html">About Us</a></li>
                    <li><a href="#contact">Contact</a></li>
                    <li><a href="for-businesses.html">For Businesses</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>Community</h4>
                <ul>
                    <li><a href="#blog">Blog</a></li>
                    <li><a href="#stories">Stories</a></li>
                    <li><a href="#events">Events</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>Connect</h4>
                <ul>
                    <li><a href="#instagram">Instagram</a></li>
                    <li><a href="#twitter">Twitter</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 Fl√¢nerie. All rights reserved. Made with ‚ù§Ô∏è for urban explorers.</p>
        </div>
    </footer>
    
    <script>
        // SLIDESHOW - APPROVED TIMING
        const typewriterText = "Every year, 200,000 small businesses close in the U.S. alone.";
        let charIndex = 0;
        
        function startSlideshow() {
            const slideshowOverlay = document.getElementById('slideshow-overlay');
            document.body.classList.add('choreography-active');
            slideshowOverlay.classList.add('active');
            
            // Slide 1: Definition (4 sec)
            setTimeout(() => {
                document.getElementById('slide-definition').classList.remove('active');
                document.getElementById('slide-typewriter-with-image').classList.add('active');
                
                // Start image fade when typing starts (slower now - 4s)
                setTimeout(() => {
                    document.getElementById('empty-street-section').classList.add('fading');
                }, 100);
                
                // Start typewriter
                slideshowTypewriter(() => {
                    // Hold for 5 seconds after typing finishes
                    setTimeout(() => {
                        document.getElementById('slide-typewriter-with-image').classList.remove('active');
                        document.getElementById('slide-paragraph-with-image').classList.add('active');
                        
                        // Paragraph HOLDS for 4 seconds (people can read)
                        setTimeout(() => {
                            // YOU fades in
                            document.getElementById('you-text').classList.add('showing');
                            
                            // Wait for YOU to finish fading (1.5 sec), then start image
                            setTimeout(() => {
                                document.getElementById('shopping-street-section').classList.add('fading');
                                
                                // Wait for image to finish (3 sec), then hold
                                setTimeout(() => {
                                    // Everything holds for 3 seconds
                                    setTimeout(() => {
                                        document.getElementById('slide-paragraph-with-image').classList.remove('active');
                                        document.getElementById('slide-welcome').classList.add('active');
                                        
                                        // After 2 sec, move Welcome up and fade in tagline
                                        setTimeout(() => {
                                            document.getElementById('welcome-text').classList.add('move-up');
                                            document.getElementById('tagline-text').classList.add('fade-in');
                                            
                                            // Hold for 4 sec, then END
                                            setTimeout(() => {
                                                slideshowOverlay.style.transition = 'opacity 1s ease-out';
                                                slideshowOverlay.style.opacity = '0';
                                                
                                                setTimeout(() => {
                                                    slideshowOverlay.style.display = 'none';
                                                    document.body.classList.remove('choreography-active');
                                                }, 1000);
                                            }, 4000);
                                        }, 2000);
                                    }, 3000);
                                }, 3000);
                            }, 1500);
                        }, 4000);
                    }, 5000);
                });
            }, 4000);
        }
        
        function slideshowTypewriter(callback) {
            const element = document.getElementById('slideshow-typewriter-sentence');
            element.textContent = '';
            charIndex = 0;
            
            function type() {
                if (charIndex < typewriterText.length) {
                    element.textContent += typewriterText.charAt(charIndex);
                    charIndex++;
                    setTimeout(type, 50);
                } else {
                    callback();
                }
            }
            type();
        }
        
        // Slideshow controls
        document.getElementById('skip-btn').addEventListener('click', function() {
            const slideshowOverlay = document.getElementById('slideshow-overlay');
            slideshowOverlay.style.transition = 'opacity 0.5s ease-out';
            slideshowOverlay.style.opacity = '0';
            
            setTimeout(() => {
                slideshowOverlay.style.display = 'none';
                document.body.classList.remove('choreography-active');
            }, 500);
        });
        
        document.getElementById('pause-btn').addEventListener('click', function() {
            this.textContent = this.textContent === '‚è∏' ? '‚ñ∂' : '‚è∏';
        });
        
        document.getElementById('rewind-btn').addEventListener('click', function() {
            charIndex = 0;
            document.getElementById('slideshow-typewriter-sentence').textContent = '';
            // Reset all states
            document.querySelectorAll('.fading, .showing, .move-up, .fade-in').forEach(el => {
                el.classList.remove('fading', 'showing', 'move-up', 'fade-in');
            });
            startSlideshow();
        });
        
        startSlideshow();
        
        // Rotating hero phrases
        let currentHeroTextIndex = 0;
        const heroTextSpans = document.querySelectorAll('.hero .rotating-text span');
        
        function rotateHeroText() {
            heroTextSpans[currentHeroTextIndex].classList.remove('active');
            currentHeroTextIndex = (currentHeroTextIndex + 1) % heroTextSpans.length;
            heroTextSpans[currentHeroTextIndex].classList.add('active');
        }
        
        setInterval(rotateHeroText, 3000);
        
        // Scroll to content
        function scrollToContent() {
            document.querySelector('.main-content').scrollIntoView({ behavior: 'smooth' });
        }
    </script>
    
    <!-- Leaflet JavaScript -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <script>
        // Map variables
        let journeyMap = null;
        let searchMap = null;
        let swarmMap = null;
        let routeMarkers = [];
        let routePath = null;
        let routeCoordinates = [];
        
        // Toggle Sections - Opens fullscreen modal with maps
        function toggleSection(sectionId) {
            // Create fullscreen modal
            const modal = document.createElement('div');
            modal.className = 'modal-fullscreen show';
            modal.id = 'fullscreen-' + sectionId;
            modal.style.cssText = 'display: block; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100vh; background-color: rgba(10, 10, 10, 0.98);';
            
            const closeBtn = document.createElement('button');
            closeBtn.innerHTML = '&times;';
            closeBtn.style.cssText = 'position: fixed; top: 2rem; right: 2rem; width: 50px; height: 50px; background: rgba(107, 155, 158, 0.9); border: none; border-radius: 50%; color: white; font-size: 2rem; cursor: pointer; z-index: 2001;';
            closeBtn.onclick = () => {
                modal.remove();
                // Reset map variables so they can be recreated
                journeyMap = null;
                searchMap = null;
                swarmMap = null;
            };
            
            const content = document.createElement('div');
            content.style.cssText = 'padding: 3rem; max-width: 1600px; margin: 0 auto; height: 100vh; overflow-y: auto;';
            
            // Create content based on section
            if (sectionId === 'journey-map') {
                content.innerHTML = `
                    <h2 style="color: var(--accent-color); margin-bottom: 1rem;">Share Your Journey</h2>
                    <p style="color: #d4d4d4; margin-bottom: 1.5rem;">Search for a location or business to get started, or click on the map to add waypoints and create your custom route.</p>
                    <div style="margin-bottom: 1rem; position: relative;">
                        <input type="text" id="mapSearch" placeholder="Search address, zip code, or business name..." style="width: 100%; padding: 1rem; border: 2px solid rgba(107, 155, 158, 0.3); border-radius: 15px; background: rgba(40, 40, 40, 0.9); color: #e0e0e0; font-size: 1rem; font-family: 'Poppins', sans-serif;">
                        <div id="mapSearchSuggestions" style="position: absolute; top: 100%; left: 0; right: 0; background: rgba(30, 30, 30, 0.98); border: 2px solid rgba(107, 155, 158, 0.3); border-top: none; border-radius: 0 0 15px 15px; max-height: 300px; overflow-y: auto; z-index: 1000; display: none;"></div>
                    </div>
                    <div id="map" style="height: 500px; border-radius: 15px; margin: 1rem 0;"></div>
                    <div style="margin-top: 1rem; display: flex; gap: 1rem;">
                        <button class="feature-btn" onclick="openSaveRouteModal()">Save Route</button>
                        <button class="feature-btn" onclick="clearRoute()">Clear Route</button>
                        <button class="feature-btn" onclick="showToast('Share link copied!')">Share Route</button>
                    </div>
                `;
            } else if (sectionId === 'search') {
                content.innerHTML = `
                    <h2 style="color: var(--accent-color); margin-bottom: 1rem;">Search Routes</h2>
                    <p style="color: #d4d4d4; margin-bottom: 1.5rem;">Find the perfect route for your next adventure</p>
                    <div style="margin-bottom: 1rem; position: relative;">
                        <input type="text" id="searchMapLocation" placeholder="Search address, zip code, or business name..." style="width: 100%; padding: 1rem; border: 2px solid rgba(107, 155, 158, 0.3); border-radius: 15px; background: rgba(40, 40, 40, 0.9); color: #e0e0e0; font-size: 1rem; font-family: 'Poppins', sans-serif; margin-bottom: 1rem;">
                        <div id="searchMapSuggestions" style="position: absolute; top: 100%; left: 0; right: 0; background: rgba(30, 30, 30, 0.98); border: 2px solid rgba(107, 155, 158, 0.3); border-top: none; border-radius: 0 0 15px 15px; max-height: 300px; overflow-y: auto; z-index: 1000; display: none; margin-top: -1rem;"></div>
                    </div>
                    <div style="display: flex; gap: 1rem; margin-bottom: 1rem;">
                        <input type="text" id="searchByCategory" placeholder="Search by interest, location, or mood..." style="flex: 1; padding: 1rem; border: 2px solid rgba(107, 155, 158, 0.3); border-radius: 15px; background: rgba(40, 40, 40, 0.9); color: #e0e0e0; font-size: 1rem; font-family: 'Poppins', sans-serif;">
                        <button class="feature-btn" onclick="showToast('Searching routes...')">Search</button>
                    </div>
                    <div id="search-map" style="height: 500px; border-radius: 15px; margin: 1rem 0;"></div>
                    <div id="search-results" style="margin-top: 2rem; color: #d4d4d4;"></div>
                `;
            } else if (sectionId === 'swarms') {
                content.innerHTML = `
                    <h2 style="color: var(--accent-color); margin-bottom: 1rem;">Shopping Swarms</h2>
                    <p style="color: #d4d4d4; margin-bottom: 1.5rem;">Organize or join community walks where locals explore, shop, and support businesses together ‚Äî a spontaneous celebration of local culture!</p>
                    <button class="feature-btn" onclick="showToast('Create swarm feature coming soon!')">Create Shopping Swarm</button>
                    
                    <div style="background: rgba(40, 40, 40, 0.8); padding: 1.5rem; border-radius: 15px; margin: 2rem 0;">
                        <h3 style="color: var(--accent-light); margin-bottom: 1rem;">üîç Search Near Me</h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                            <div>
                                <label style="display: block; margin-bottom: 0.5rem; color: #d4d4d4;">Country</label>
                                <select style="width: 100%; padding: 0.8rem; border: 2px solid rgba(107, 155, 158, 0.3); border-radius: 10px; background: rgba(40, 40, 40, 0.9); color: #e0e0e0;">
                                    <option>Select Country</option>
                                    <option>United States</option>
                                </select>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 0.5rem; color: #d4d4d4;">State/Province</label>
                                <select style="width: 100%; padding: 0.8rem; border: 2px solid rgba(107, 155, 158, 0.3); border-radius: 10px; background: rgba(40, 40, 40, 0.9); color: #e0e0e0;">
                                    <option>Select State/Province</option>
                                    <option>Colorado</option>
                                </select>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 0.5rem; color: #d4d4d4;">City</label>
                                <select style="width: 100%; padding: 0.8rem; border: 2px solid rgba(107, 155, 158, 0.3); border-radius: 10px; background: rgba(40, 40, 40, 0.9); color: #e0e0e0;">
                                    <option>Select City</option>
                                    <option>Denver</option>
                                </select>
                            </div>
                        </div>
                        <div style="margin-bottom: 1rem; position: relative;">
                            <label style="display: block; margin-bottom: 0.5rem; color: #d4d4d4;">Or Search by Address/Zip</label>
                            <input type="text" id="swarmLocationSearch" placeholder="Enter address, zip code, or business name..." style="width: 100%; padding: 0.8rem; border: 2px solid rgba(107, 155, 158, 0.3); border-radius: 10px; background: rgba(40, 40, 40, 0.9); color: #e0e0e0; font-family: 'Poppins', sans-serif;">
                            <div id="swarmSearchSuggestions" style="position: absolute; top: calc(100% + 0.5rem); left: 0; right: 0; background: rgba(30, 30, 30, 0.98); border: 2px solid rgba(107, 155, 158, 0.3); border-top: none; border-radius: 0 0 15px 15px; max-height: 300px; overflow-y: auto; z-index: 1000; display: none; margin-top: 0.5rem;"></div>
                        </div>
                        <button class="feature-btn" onclick="showToast('Searching swarms...')">Search</button>
                    </div>
                    
                    <div id="swarm-map" style="height: 500px; border-radius: 15px; margin: 1rem 0;"></div>
                    
                    <h3 style="color: var(--accent-color); margin: 2rem 0 1rem;">Active Shopping Swarms</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem;">
                        <div style="background: rgba(40, 40, 40, 0.8); padding: 1.5rem; border-radius: 15px;">
                            <h4 style="color: var(--accent-color);">Saturday Market Crawl</h4>
                            <p style="color: #d4d4d4;">üìÖ This Saturday, 10 AM<br>üìç Downtown Farmers Market</p>
                            <p style="color: var(--accent-light);">üë• 23 people joined</p>
                        </div>
                        <div style="background: rgba(40, 40, 40, 0.8); padding: 1.5rem; border-radius: 15px;">
                            <h4 style="color: var(--accent-color);">Art Gallery Night Walk</h4>
                            <p style="color: #d4d4d4;">üìÖ Friday, 6 PM<br>üìç Arts District</p>
                            <p style="color: var(--accent-light);">üë• 15 people joined</p>
                        </div>
                        <div style="background: rgba(40, 40, 40, 0.8); padding: 1.5rem; border-radius: 15px;">
                            <h4 style="color: var(--accent-color);">Coffee Shop Marathon</h4>
                            <p style="color: #d4d4d4;">üìÖ Sunday, 9 AM<br>üìç Various Locations</p>
                            <p style="color: var(--accent-light);">üë• 31 people joined</p>
                        </div>
                    </div>
                `;
            } else if (sectionId === 'events') {
                content.innerHTML = `
                    <h2 style="color: var(--accent-color); margin-bottom: 1rem;">Local Events</h2>
                    <p style="color: #d4d4d4; margin-bottom: 1.5rem;">Discover and promote neighborhood celebrations, block parties, sidewalk sales, and community festivals.</p>
                    <button class="feature-btn" onclick="showToast('Promote event feature coming soon!')">Promote Your Event</button>
                    
                    <div style="background: rgba(40, 40, 40, 0.8); padding: 1.5rem; border-radius: 15px; margin: 2rem 0;">
                        <h3 style="color: var(--accent-light); margin-bottom: 1rem;">üîç Find Events Near You</h3>
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                            <div>
                                <label style="display: block; margin-bottom: 0.5rem; color: #d4d4d4;">Country</label>
                                <select style="width: 100%; padding: 0.8rem; border: 2px solid rgba(107, 155, 158, 0.3); border-radius: 10px; background: rgba(40, 40, 40, 0.9); color: #e0e0e0;">
                                    <option>Select Country</option>
                                    <option>United States</option>
                                </select>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 0.5rem; color: #d4d4d4;">State/Province</label>
                                <select style="width: 100%; padding: 0.8rem; border: 2px solid rgba(107, 155, 158, 0.3); border-radius: 10px; background: rgba(40, 40, 40, 0.9); color: #e0e0e0;">
                                    <option>Select State/Province</option>
                                    <option>Colorado</option>
                                </select>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 0.5rem; color: #d4d4d4;">City</label>
                                <select style="width: 100%; padding: 0.8rem; border: 2px solid rgba(107, 155, 158, 0.3); border-radius: 10px; background: rgba(40, 40, 40, 0.9); color: #e0e0e0;">
                                    <option>Select City</option>
                                    <option>Denver</option>
                                </select>
                            </div>
                        </div>
                        <div style="margin-bottom: 1rem; position: relative;">
                            <label style="display: block; margin-bottom: 0.5rem; color: #d4d4d4;">Or Search by Address/Zip</label>
                            <input type="text" id="eventLocationSearch" placeholder="Enter address, zip code, or business name..." style="width: 100%; padding: 0.8rem; border: 2px solid rgba(107, 155, 158, 0.3); border-radius: 10px; background: rgba(40, 40, 40, 0.9); color: #e0e0e0; font-family: 'Poppins', sans-serif;">
                            <div id="eventSearchSuggestions" style="position: absolute; top: calc(100% + 0.5rem); left: 0; right: 0; background: rgba(30, 30, 30, 0.98); border: 2px solid rgba(107, 155, 158, 0.3); border-top: none; border-radius: 0 0 15px 15px; max-height: 300px; overflow-y: auto; z-index: 1000; display: none; margin-top: 0.5rem;"></div>
                        </div>
                        <button class="feature-btn" onclick="showToast('Searching events...')">Search Events</button>
                    </div>
                    
                    <h3 style="color: var(--accent-color); margin: 2rem 0 1rem;">Upcoming Events</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem;">
                        <div style="background: rgba(40, 40, 40, 0.8); padding: 1.5rem; border-radius: 15px;">
                            <span style="display: inline-block; background: var(--accent-light); color: white; padding: 0.3rem 0.8rem; border-radius: 15px; font-size: 0.75rem; margin-bottom: 0.8rem; font-weight: 600;">Block Party</span>
                            <h4 style="color: var(--accent-color);">Highland Street Festival</h4>
                            <p style="color: #d4d4d4;">üìÖ Saturday, June 15, 12-6 PM<br>üìç Highland Neighborhood<br>üéµ Live music, local vendors, food trucks</p>
                        </div>
                        <div style="background: rgba(40, 40, 40, 0.8); padding: 1.5rem; border-radius: 15px;">
                            <span style="display: inline-block; background: var(--accent-light); color: white; padding: 0.3rem 0.8rem; border-radius: 15px; font-size: 0.75rem; margin-bottom: 0.8rem; font-weight: 600;">Art Walk</span>
                            <h4 style="color: var(--accent-color);">First Friday Gallery Stroll</h4>
                            <p style="color: #d4d4d4;">üìÖ First Friday, 6-9 PM<br>üìç Santa Fe Arts District<br>üé® Free gallery openings, artist demos</p>
                        </div>
                        <div style="background: rgba(40, 40, 40, 0.8); padding: 1.5rem; border-radius: 15px;">
                            <span style="display: inline-block; background: var(--accent-light); color: white; padding: 0.3rem 0.8rem; border-radius: 15px; font-size: 0.75rem; margin-bottom: 0.8rem; font-weight: 600;">Sidewalk Sale</span>
                            <h4 style="color: var(--accent-color);">Pearl Street Summer Sale</h4>
                            <p style="color: #d4d4d4;">üìÖ July 20-22, 10 AM-7 PM<br>üìç Pearl Street Mall<br>üõçÔ∏è Special discounts, outdoor displays</p>
                        </div>
                    </div>
                `;
            }
            
            modal.appendChild(closeBtn);
            modal.appendChild(content);
            document.body.appendChild(modal);
            
            // Initialize maps after DOM is ready
            setTimeout(() => {
                if (sectionId === 'journey-map') {
                    const mapElement = document.getElementById('map');
                    if (mapElement && !journeyMap) {
                        journeyMap = L.map(mapElement).setView([39.7392, -104.9903], 13);
                        L.tileLayer('https://api.mapbox.com/styles/v1/mapbox/streets-v11/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoiaGlnaGRlZnBhbnRzIiwiYSI6ImNtaHpiNGt0NzBsNTIyam9saW45YmQ0Z3gifQ.EPETOMFI41QInYccb4Cehg', {
                            attribution: '¬© Mapbox ¬© OpenStreetMap',
                            tileSize: 512,
                            zoomOffset: -1
                        }).addTo(journeyMap);
                        
                        journeyMap.on('click', function(e) {
                            addWaypoint(e.latlng);
                        });
                        
                        // Add search autocomplete functionality
                        const searchInput = document.getElementById('mapSearch');
                        const suggestionsDiv = document.getElementById('mapSearchSuggestions');
                        let searchTimeout;
                        
                        if (searchInput && suggestionsDiv) {
                            searchInput.addEventListener('input', function(e) {
                                const query = e.target.value.trim();
                                clearTimeout(searchTimeout);
                                
                                if (query.length < 2) {
                                    suggestionsDiv.style.display = 'none';
                                    return;
                                }
                                
                                searchTimeout = setTimeout(() => {
                                    fetchLocationSuggestions(query, suggestionsDiv, journeyMap, searchInput);
                                }, 100);
                            });
                            
                            searchInput.addEventListener('keypress', function(e) {
                                if (e.key === 'Enter' && suggestionsDiv.style.display === 'none') {
                                    searchLocation(searchInput.value, journeyMap);
                                }
                            });
                            
                            document.addEventListener('click', function(e) {
                                if (!searchInput.contains(e.target) && !suggestionsDiv.contains(e.target)) {
                                    suggestionsDiv.style.display = 'none';
                                }
                            });
                        }
                    }
                } else if (sectionId === 'search') {
                    const mapElement = document.getElementById('search-map');
                    if (mapElement && !searchMap) {
                        searchMap = L.map(mapElement).setView([39.7392, -104.9903], 13);
                        L.tileLayer('https://api.mapbox.com/styles/v1/mapbox/streets-v11/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoiaGlnaGRlZnBhbnRzIiwiYSI6ImNtaHpiNGt0NzBsNTIyam9saW45YmQ0Z3gifQ.EPETOMFI41QInYccb4Cehg', {
                            attribution: '¬© Mapbox ¬© OpenStreetMap',
                            tileSize: 512,
                            zoomOffset: -1
                        }).addTo(searchMap);
                        
                        // Add search autocomplete functionality
                        const searchInput = document.getElementById('searchMapLocation');
                        const suggestionsDiv = document.getElementById('searchMapSuggestions');
                        let searchTimeout;
                        
                        if (searchInput && suggestionsDiv) {
                            searchInput.addEventListener('input', function(e) {
                                const query = e.target.value.trim();
                                clearTimeout(searchTimeout);
                                
                                if (query.length < 2) {
                                    suggestionsDiv.style.display = 'none';
                                    return;
                                }
                                
                                searchTimeout = setTimeout(() => {
                                    fetchLocationSuggestions(query, suggestionsDiv, searchMap, searchInput);
                                }, 100);
                            });
                            
                            searchInput.addEventListener('keypress', function(e) {
                                if (e.key === 'Enter' && suggestionsDiv.style.display === 'none') {
                                    searchLocation(searchInput.value, searchMap);
                                }
                            });
                            
                            document.addEventListener('click', function(e) {
                                if (!searchInput.contains(e.target) && !suggestionsDiv.contains(e.target)) {
                                    suggestionsDiv.style.display = 'none';
                                }
                            });
                        }
                    }
                } else if (sectionId === 'swarms') {
                    const mapElement = document.getElementById('swarm-map');
                    if (mapElement && !swarmMap) {
                        swarmMap = L.map(mapElement).setView([39.7392, -104.9903], 13);
                        L.tileLayer('https://api.mapbox.com/styles/v1/mapbox/streets-v11/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoiaGlnaGRlZnBhbnRzIiwiYSI6ImNtaHpiNGt0NzBsNTIyam9saW45YmQ0Z3gifQ.EPETOMFI41QInYccb4Cehg', {
                            attribution: '¬© Mapbox ¬© OpenStreetMap',
                            tileSize: 512,
                            zoomOffset: -1
                        }).addTo(swarmMap);
                        
                        // Add sample swarm markers
                        const swarms = [
                            { lat: 39.7392, lng: -104.9903, name: 'Saturday Market Crawl', participants: 23 },
                            { lat: 39.7420, lng: -104.9880, name: 'Art Gallery Night Walk', participants: 15 },
                            { lat: 39.7350, lng: -104.9950, name: 'Coffee Shop Marathon', participants: 31 }
                        ];
                        
                        swarms.forEach(swarm => {
                            L.marker([swarm.lat, swarm.lng]).addTo(swarmMap)
                                .bindPopup(`<strong>${swarm.name}</strong><br>üë• ${swarm.participants} people`);
                        });
                        
                        // Add search autocomplete functionality for swarms
                        const swarmSearchInput = document.getElementById('swarmLocationSearch');
                        const swarmSuggestionsDiv = document.getElementById('swarmSearchSuggestions');
                        let swarmSearchTimeout;
                        
                        if (swarmSearchInput && swarmSuggestionsDiv) {
                            swarmSearchInput.addEventListener('input', function(e) {
                                const query = e.target.value.trim();
                                clearTimeout(swarmSearchTimeout);
                                
                                if (query.length < 2) {
                                    swarmSuggestionsDiv.style.display = 'none';
                                    return;
                                }
                                
                                swarmSearchTimeout = setTimeout(() => {
                                    fetchLocationSuggestions(query, swarmSuggestionsDiv, swarmMap, swarmSearchInput);
                                }, 100);
                            });
                            
                            swarmSearchInput.addEventListener('keypress', function(e) {
                                if (e.key === 'Enter' && swarmSuggestionsDiv.style.display === 'none') {
                                    searchLocation(swarmSearchInput.value, swarmMap);
                                }
                            });
                            
                            document.addEventListener('click', function(e) {
                                if (!swarmSearchInput.contains(e.target) && !swarmSuggestionsDiv.contains(e.target)) {
                                    swarmSuggestionsDiv.style.display = 'none';
                                }
                            });
                        }
                    }
                } else if (sectionId === 'events') {
                    // Add autocomplete for events search
                    const eventSearchInput = document.getElementById('eventLocationSearch');
                    const eventSuggestionsDiv = document.getElementById('eventSearchSuggestions');
                    let eventSearchTimeout;
                    
                    if (eventSearchInput && eventSuggestionsDiv) {
                        eventSearchInput.addEventListener('input', function(e) {
                            const query = e.target.value.trim();
                            clearTimeout(eventSearchTimeout);
                            
                            if (query.length < 2) {
                                eventSuggestionsDiv.style.display = 'none';
                                return;
                            }
                            
                            eventSearchTimeout = setTimeout(() => {
                                fetchLocationSuggestions(query, eventSuggestionsDiv, null, eventSearchInput);
                            }, 100);
                        });
                        
                        eventSearchInput.addEventListener('keypress', function(e) {
                            if (e.key === 'Enter' && eventSuggestionsDiv.style.display === 'none') {
                                showToast('Searching events in ' + eventSearchInput.value);
                            }
                        });
                        
                        document.addEventListener('click', function(e) {
                            if (!eventSearchInput.contains(e.target) && !eventSuggestionsDiv.contains(e.target)) {
                                eventSuggestionsDiv.style.display = 'none';
                            }
                        });
                    }
                }
            }, 300);
        }
        
        function addWaypoint(latlng) {
            const waypointNumber = routeCoordinates.length + 1;
            const numberIcon = L.divIcon({
                className: 'numbered-marker',
                html: `<div style="background: var(--accent-color); color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; border: 3px solid white; box-shadow: 0 2px 8px rgba(0,0,0,0.3);">${waypointNumber}</div>`,
                iconSize: [30, 30],
                iconAnchor: [15, 15]
            });
            
            const marker = L.marker(latlng, { icon: numberIcon }).addTo(journeyMap);
            routeMarkers.push(marker);
            routeCoordinates.push([latlng.lat, latlng.lng]);
            
            if (routePath) {
                journeyMap.removeLayer(routePath);
            }
            
            if (routeCoordinates.length > 1) {
                routePath = L.polyline(routeCoordinates, { color: 'var(--accent-color)', weight: 4 }).addTo(journeyMap);
            }
            
            showToast(`Waypoint ${waypointNumber} added!`);
        }
        
        function clearRoute() {
            routeMarkers.forEach(marker => journeyMap.removeLayer(marker));
            if (routePath) journeyMap.removeLayer(routePath);
            routeMarkers = [];
            routeCoordinates = [];
            routePath = null;
            showToast('Route cleared!');
        }
        
        // Fetch location suggestions using Mapbox Geocoding API
        function fetchLocationSuggestions(query, suggestionsDiv, map, inputElement) {
            const accessToken = 'pk.eyJ1IjoiaGlnaGRlZnBhbnRzIiwiYSI6ImNtaHpiNGt0NzBsNTIyam9saW45YmQ0Z3gifQ.EPETOMFI41QInYccb4Cehg';
            const url = `https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(query)}.json?access_token=${accessToken}&country=us&limit=8&types=place,address,poi`;
            
            fetch(url)
            .then(response => response.json())
            .then(data => {
                if (data.features && data.features.length > 0) {
                    suggestionsDiv.innerHTML = '';
                    data.features.forEach(result => {
                        const item = document.createElement('div');
                        item.style.cssText = 'padding: 1rem; color: #d4d4d4; cursor: pointer; border-bottom: 1px solid rgba(107, 155, 158, 0.1); transition: background 0.2s;';
                        item.onmouseover = () => item.style.background = 'rgba(107, 155, 158, 0.2)';
                        item.onmouseout = () => item.style.background = '';
                        
                        const main = document.createElement('div');
                        main.style.cssText = 'font-weight: 600; color: var(--accent-light);';
                        main.textContent = result.text || result.place_name.split(',')[0];
                        
                        const detail = document.createElement('div');
                        detail.style.cssText = 'font-size: 0.9rem; color: #999; margin-top: 0.2rem;';
                        detail.textContent = result.place_name;
                        
                        item.appendChild(main);
                        item.appendChild(detail);
                        
                        item.addEventListener('click', function() {
                            const lon = result.center[0];
                            const lat = result.center[1];
                            
                            // Only update map if map exists
                            if (map) {
                                map.setView([lat, lon], 15);
                                L.marker([lat, lon])
                                    .addTo(map)
                                    .bindPopup(`<strong>${result.place_name}</strong>`)
                                    .openPopup();
                            }
                            
                            suggestionsDiv.style.display = 'none';
                            inputElement.value = result.place_name;
                            showToast(`Found: ${result.text}`);
                        });
                        
                        suggestionsDiv.appendChild(item);
                    });
                    suggestionsDiv.style.display = 'block';
                } else {
                    suggestionsDiv.style.display = 'none';
                }
            })
            .catch(error => {
                console.error('Autocomplete error:', error);
                suggestionsDiv.style.display = 'none';
            });
        }
        
        // Search location using Mapbox Geocoding API
        function searchLocation(query, map) {
            if (!query || query.trim() === '') {
                showToast('Please enter a location to search');
                return;
            }
            
            const accessToken = 'pk.eyJ1IjoiaGlnaGRlZnBhbnRzIiwiYSI6ImNtaHpiNGt0NzBsNTIyam9saW45YmQ0Z3gifQ.EPETOMFI41QInYccb4Cehg';
            const url = `https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(query)}.json?access_token=${accessToken}&country=us&limit=1`;
            
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    if (data.features && data.features.length > 0) {
                        const result = data.features[0];
                        const lon = result.center[0];
                        const lat = result.center[1];
                        
                        const isZipCode = /^\d{5}$/.test(query.trim());
                        const zoom = isZipCode ? 13 : 15;
                        
                        map.setView([lat, lon], zoom);
                        
                        L.marker([lat, lon])
                            .addTo(map)
                            .bindPopup(`<strong>${result.place_name}</strong>`)
                            .openPopup();
                        
                        const locationName = result.text || result.place_name.split(',')[0];
                        showToast(`Found: ${locationName}`);
                    } else {
                        showToast('Location not found. Try being more specific.');
                    }
                })
                .catch(error => {
                    console.error('Search error:', error);
                    showToast('Search failed. Please try again.');
                });
        }
        
        // Open Save Route Modal
        function openSaveRouteModal() {
            if (routeCoordinates.length < 2) {
                showToast('Please add at least 2 waypoints!');
                return;
            }
            
            const modal = document.createElement('div');
            modal.id = 'saveRouteModal';
            modal.style.cssText = 'position: fixed; z-index: 10001; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.8); display: flex; align-items: center; justify-content: center;';
            
            modal.innerHTML = `
                <div style="background: rgba(25, 25, 25, 0.98); border-radius: 20px; padding: 2rem; max-width: 600px; width: 90%; max-height: 90vh; overflow-y: auto; border: 2px solid rgba(107, 155, 158, 0.3);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                        <h2 style="color: var(--accent-color);">Save Your Route</h2>
                        <span onclick="document.getElementById('saveRouteModal').remove()" style="font-size: 2rem; color: #d4d4d4; cursor: pointer; transition: color 0.3s;">&times;</span>
                    </div>
                    <div style="margin-bottom: 1.5rem;">
                        <label style="display: block; color: #d4d4d4; margin-bottom: 0.5rem; font-weight: 500;">Route Name *</label>
                        <input type="text" id="routeName" placeholder="e.g., Morning Coffee Trail" style="width: 100%; padding: 0.8rem; border: 2px solid rgba(107, 155, 158, 0.3); border-radius: 10px; background: rgba(40, 40, 40, 0.9); color: #e0e0e0; font-family: 'Poppins', sans-serif;">
                    </div>
                    <div style="margin-bottom: 1.5rem;">
                        <label style="display: block; color: #d4d4d4; margin-bottom: 0.5rem; font-weight: 500;">Description</label>
                        <textarea id="routeDescription" rows="3" placeholder="Describe your route..." style="width: 100%; padding: 0.8rem; border: 2px solid rgba(107, 155, 158, 0.3); border-radius: 10px; background: rgba(40, 40, 40, 0.9); color: #e0e0e0; font-family: 'Poppins', sans-serif;"></textarea>
                    </div>
                    <div style="margin-bottom: 1.5rem;">
                        <label style="display: block; color: #d4d4d4; margin-bottom: 0.5rem; font-weight: 500;">Category</label>
                        <select id="routeCategory" style="width: 100%; padding: 0.8rem; border: 2px solid rgba(107, 155, 158, 0.3); border-radius: 10px; background: rgba(40, 40, 40, 0.9); color: #e0e0e0; font-family: 'Poppins', sans-serif;">
                            <option value="">Select a category...</option>
                            <option value="coffee">‚òï Coffee Shops</option>
                            <option value="tacos">üåÆ Tacos & Mexican</option>
                            <option value="food">üç¥ Food & Dining</option>
                            <option value="bars">üç∫ Bars & Nightlife</option>
                            <option value="bookstores">üìö Bookstores</option>
                            <option value="shopping">üõçÔ∏è Shopping & Boutiques</option>
                            <option value="clothing">üëï Clothing & Fashion</option>
                            <option value="art">üé® Art & Culture</option>
                            <option value="parks">üå≥ Parks & Nature</option>
                            <option value="historic">üèõÔ∏è Historic Sites</option>
                            <option value="other">‚ú® Other</option>
                        </select>
                    </div>
                    <div style="display: flex; gap: 1rem; justify-content: flex-end; margin-top: 2rem;">
                        <button onclick="document.getElementById('saveRouteModal').remove()" style="padding: 0.8rem 2rem; border: none; border-radius: 25px; cursor: pointer; font-weight: 600; background: rgba(60, 60, 60, 0.9); color: #d4d4d4;">Cancel</button>
                        <button onclick="confirmSaveRoute()" style="padding: 0.8rem 2rem; border: none; border-radius: 25px; cursor: pointer; font-weight: 600; background: linear-gradient(135deg, var(--accent-color), var(--accent-light)); color: white;">Save Route</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }
        
        function confirmSaveRoute() {
            const name = document.getElementById('routeName').value;
            if (!name) {
                showToast('Please enter a route name!');
                return;
            }
            document.getElementById('saveRouteModal').remove();
            showToast(`Route "${name}" saved successfully!`);
        }
        
        // Toast Notification
        function showToast(message) {
            const toast = document.createElement('div');
            toast.style.cssText = 'position: fixed; bottom: 2rem; right: 2rem; background: rgba(107, 155, 158, 0.95); color: white; padding: 1rem 2rem; border-radius: 10px; box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3); z-index: 3000;';
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }
    </script>
</body>
</html>
